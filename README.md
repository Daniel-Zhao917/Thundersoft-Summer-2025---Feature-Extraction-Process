# Thundersoft-Summer-2025---Feature-Extraction-Process
## Extraction
So in our ThunderSoft dataset and onedrive dataset, we have total of fourteen people, named "4B725FCB", "19DA666D", "4B73E8AB", "4B73288B", "4BA9149B", "C60F509C", "C70E7E2C", "C719B90C", "C705493C", "DA9FFD3C", "DA96B45C", "DAA1F29C", "DAA49B9C", and "DAA110DC". Each people has three BAC levels, for each BAC level of a people, we have two channels, so the structure is 2 (the two people) × 3 (BAC levels) × 2 (channels). However, only "4B725FCB" and "19DA666D" (the first two people) has two channels (because this project currently only need channel two, so we omit channel one). Thus, the total number of csv files is 48 (2 × 6 + 12 × 3). The number of attributes for each csv file is not the same, but each all have "gaze_angle_x," "gaze_angle_y," "pose_Rx," "pose_Ry," "pose_Rz," "EAR," "Pupil_Scale (Left)," and "Pupil_Scale (Right)." So there's no "P-scale," but has "Pupil_Scale (Left)" and "Pupil_Scale (Right)."

## Overall Data Processing Structure
There are 5 steps that process the 48 raw csv data. The first step is to calculate the P-scale and normalize the 7 attributes ("gaze_angle_x," "gaze_angle_y," "pose_Rx," "pose_Ry," "pose_Rz," "EAR," and "P-scale"). The second step is to extract these 7 attributes. The third step is to use the sliding window algorithm to create the dataset. The fourth step is to create the label for each dataset. The fifth step is to export csv. We will explain the steps each in a section. Above are the abstract methodologies, in the python file, we use 3 functions to perform the 5 steps, one will normalize and extract the data, one will create the window list and label list, one will export csv. We will also explain the functions each in a section.

## Normalization
The calculation of P-scale is simply the average of "Pupil_Scale (Left)" and "Pupil_Scale (Right)." The normalization is z-score normalizing, (value - mean) / std.

## Extraction
We simply just extract "gaze_angle_x," "gaze_angle_y," "pose_Rx," "pose_Ry," "pose_Rz," "EAR," and "P-scale." Please note that we didn't change the name of "gaze_angle_x," "gaze_angle_y" to "gaze_x" and "gaze_y."

## overall_normalize function
In python, the overall_normalize function will normalize and extract data. The function takes three arguments: path (string), file_name_list (string), only_channel_2 (Boolean). path is the path that stores the csv data. path that doesn't contain the csv name nor the "/" before the csv name, for example, "Step2Deliverable." file name list is a iteratable container that consist the names of the people, for example, ["19DA666D", "4B725FCB", "4B73E8AB", "4B73288B", "4BA9149B", "C60F509C", "C70E7E2C", "C719B90C", "C705493C", "DA9FFD3C", "DA96B45C", "DAA1F29C", "DAA49B9C", "DAA110DC"] (the entire name list). only_channel_2 indicates whether to only process channel 2 data. All the csv data is required to store in a same folder. This function Will return a series with MultiIndex, each element is a DataFrame. MultiIndex is rather complex, you don't need to know how to use the result, as the result is supposed to directly pass to the next python function to create window list and label list. For the result, if only channel 2, then the index is 2D, first dimension is people name, second is BAC level in ["0", "5", "10"]. Please note that BAC level is string, not numeric. For example, result["19DA666D"]["0"] will return the DataFrame of channel 2 of BAC 0 of "19DA666D." If only channel 2 is false, then the index is 3D, first dimension is people name, second is BAC level, third is channel in ["CH01", "CH02"]. For example, result["19DA666D"]["0"]["CH01"] will return the DataFrame of channel 1 of BAC 0 of "19DA666D."

## Sliding Window
Take the 0 BAC level, channel 1, person "4B725FCB" as an example. This csv file has 12423 rows. For window 1, we create a Python built-in list (so not a PyTorch tensor) with the dimension of 150 × 7. This window consist of frame 1 - 150 with all the 7 attributes. Let's say this list is called "list_1". list_1[0] will return a list with 7 elements, each is an attribute. Thus, this list is row-oriented, not the pandas style column-oriented (if is column-oriented, list_1[0] will return the first column (in this case, "gaze_angle_x", with a list of 150 elements)). For window 2, is frame 2 - 151. Because we have 12423 rows, we have a total of 12274 windows, the last one consists of frame 12274 to 12423. In the end, we have a list with dimension of (frame number - 149) × 150 × 7. list[0] will return the first window (a 150 × 7 list), list[0] [0] will return a list of 7. Because there are 48 csv files, we have 48 3D lists, each is a window.

## Label
For each raw csv file, we create a 1D list with the length of frame number - 149. So for the above example, we have a list of 12274 elements, all of which are 0 (so BAC level 0.00). Because there are 48 csv files, we have 48 1D lists, each is a label. Please note that label is separate from window, so we actually have 96 lists, 48 are windows, 48 are labels.

